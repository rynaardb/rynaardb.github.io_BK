<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Microservices with Vapor" /><meta property="og:locale" content="en" /><meta name="description" content="Microservices have recently got a lot of attention and Vapor provides us with all the needed tools and APIs to create a Microservices architecture relatively easy." /><meta property="og:description" content="Microservices have recently got a lot of attention and Vapor provides us with all the needed tools and APIs to create a Microservices architecture relatively easy." /><link rel="canonical" href="https://rynaardb.com/posts/microservices-with-vapor/" /><meta property="og:url" content="https://rynaardb.com/posts/microservices-with-vapor/" /><meta property="og:site_name" content="Rynaard Burger" /><meta property="og:image" content="https://rynaardb.com/assets/images/microservices-with-vapor.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-02-23T00:00:00+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://rynaardb.com/assets/images/microservices-with-vapor.png" /><meta property="twitter:title" content="Microservices with Vapor" /><meta name="twitter:site" content="@rynaardb" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-07-01T23:41:38+02:00","datePublished":"2019-02-23T00:00:00+02:00","description":"Microservices have recently got a lot of attention and Vapor provides us with all the needed tools and APIs to create a Microservices architecture relatively easy.","headline":"Microservices with Vapor","image":"https://rynaardb.com/assets/images/microservices-with-vapor.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://rynaardb.com/posts/microservices-with-vapor/"},"url":"https://rynaardb.com/posts/microservices-with-vapor/"}</script><title>Microservices with Vapor | Rynaard Burger</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Rynaard Burger"><meta name="application-name" content="Rynaard Burger"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="https://avatars.githubusercontent.com/u/185616?v=4" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">Rynaard Burger</a></div><div class="site-subtitle fst-italic">Software Engineer | Cape Town, South Africa ‚òÄÔ∏è üáøüá¶ | DevOps | GitOps | Cloud Computing | Automation | Distributed Systems | Architecture | Mobile Development</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/all-posts/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ALL POSTS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://twitter.com/rynaardb" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="https://github.com/rynaardb" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/rynaardburger/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Microservices with Vapor</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>Microservices with Vapor</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1550872800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 23, 2019 </em> </span> <span> Updated <em class="" data-ts="1688247698" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 1, 2023 </em> </span><div class="mt-3 mb-3"> <a href="/assets/images/microservices-with-vapor.png" class="popup img-link preview-img shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3C/svg%3E" data-src="/assets/images/microservices-with-vapor.png" alt="Preview Image" width="1200" height="630" class="lazyload" data-proofer-ignore></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/rynaardb">Rynaard Burger</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="768 words" > <em>4 min</em> read</span></div></div></div><div class="post-content"><p>Microservices have recently got a lot of attention and Vapor provides us with all the needed tools and APIs to create a Microservices architecture relatively easy.</p><p>Vapor has several packages providing support for the following:</p><ul><li>HTTP<li>Redis<li>SQL, MySQL, and PostgreSQL<li>WebSocket<li>Auth<li>JWT</ul><h2 id="what-is-microservices-architecture"><span class="me-2">What is Microservices Architecture?</span><a href="#what-is-microservices-architecture" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A definition of Microservices from <a href="https://en.wikipedia.org/wiki/Microservices">Wikipedia</a>:</p><p><em>Microservices are a software development technique‚Äîa variant of the service-oriented architecture (SOA) architectural style that structures an application as a collection of loosely coupled services.</em></p><h2 id="but-why"><span class="me-2">But why?</span><a href="#but-why" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The topic around monolith vs microservice architecture has already been debated in the software design and architecture community and is beyond the scope of this post.</p><p>Microservices offers several benefits some of which includes:</p><ul><li>Clear separation of concerns<li>Each service can be deployed independently<li>Promotes continuous integration and delivery<li>Easier to test (when implemented correctly)<li>Works great with Docker and Kubernetes<li>Scalable<li>Enables Agile development</ul><h2 id="api-gateway"><span class="me-2">API Gateway</span><a href="#api-gateway" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>As illustrated below, the API Gateway is the external interface and entry point to communicate with all the internal services, similar to the <a href="https://en.wikipedia.org/wiki/Facade_pattern">Facade</a> pattern in object-orientated design:</p><p><a href="/assets/images/microservices-api-gateway.png" class="popup img-link "><img data-src="/assets/images/microservices-api-gateway.png" alt="image" class="lazyload" data-proofer-ignore></a></p><p>It is the API Gateway‚Äôs responsibility to check and route each request to the corresponding internal services. The API Gateway might have other responsibilities such as authentication, access control, monitoring, logging, caching, load balancing, request shaping, etc.</p><h2 id="implementing-a-basic-api-gateway-in-vapor"><span class="me-2">Implementing a Basic API Gateway in Vapor</span><a href="#implementing-a-basic-api-gateway-in-vapor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The Gateway Controller will check each request and route it to the corresponding service:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">boot</span><span class="p">(</span><span class="nv">router</span><span class="p">:</span> <span class="kt">Router</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
    <span class="n">router</span><span class="o">.</span><span class="nf">post</span><span class="p">(</span><span class="s">"users"</span><span class="p">,</span> <span class="nv">use</span><span class="p">:</span> <span class="n">handle</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>A quick and simple solution is to check the URL of the request for a prefix, in this case checking whether the request contains the <code class="language-plaintext highlighter-rouge">/users</code> prefix:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">handle</span><span class="p">(</span><span class="n">_</span> <span class="nv">req</span><span class="p">:</span> <span class="kt">Request</span><span class="p">)</span> <span class="k">throws</span> <span class="o">-&gt;</span> <span class="kt">Future</span><span class="o">&lt;</span><span class="kt">Response</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">urlString</span><span class="o">.</span><span class="nf">hasPrefix</span><span class="p">(</span><span class="s">"/users"</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">usersHost</span> <span class="o">=</span> <span class="kt">Environment</span><span class="o">.</span><span class="nf">get</span><span class="p">(</span><span class="s">"USERS_HOST"</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span> <span class="k">throw</span> <span class="kt">Abort</span><span class="p">(</span><span class="o">.</span><span class="n">badRequest</span><span class="p">)</span> <span class="p">}</span>
        <span class="k">return</span> <span class="k">try</span> <span class="nf">handle</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="nv">host</span><span class="p">:</span> <span class="n">usersHost</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">throw</span> <span class="kt">Abort</span><span class="p">(</span><span class="o">.</span><span class="n">badRequest</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The request is then handled by creating a new HTTP client pointing to correct <code class="language-plaintext highlighter-rouge">host</code> and endpoint:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kd">func</span> <span class="nf">handle</span><span class="p">(</span><span class="n">_</span> <span class="nv">req</span><span class="p">:</span> <span class="kt">Request</span><span class="p">,</span> <span class="nv">host</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="k">throws</span> <span class="o">-&gt;</span> <span class="kt">Future</span><span class="o">&lt;</span><span class="kt">Response</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">client</span> <span class="o">=</span> <span class="k">try</span> <span class="n">req</span><span class="o">.</span><span class="nf">make</span><span class="p">(</span><span class="kt">Client</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">url</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="n">host</span> <span class="o">+</span> <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">urlString</span><span class="p">)</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="kt">Abort</span><span class="p">(</span><span class="o">.</span><span class="n">internalServerError</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
    <span class="n">req</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="nf">replaceOrAdd</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"host"</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="n">host</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">client</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="implementing-a-microservice-in-vapor"><span class="me-2">Implementing a Microservice in Vapor</span><a href="#implementing-a-microservice-in-vapor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Each service in the Microservices architecture would expose their REST API that‚Äôs consumed by other services or by the application‚Äôs clients. Some services might also implement a Web UI. At runtime, each service is often containerized using Docker and have its database, configurations, etc.</p><p>The following diagram illustrates how each of the microservices communicates with each other:</p><p><a href="/assets/images/microservices-service-communication.png" class="popup img-link "><img data-src="/assets/images/microservices-service-communication.png" alt="image" class="lazyload" data-proofer-ignore></a></p><p>Each functional area of the application is implemented by its microservice exposing a REST API consumed by other services. For example, the user service invokes the order service to retrieve order information for the given user.</p><p>Services might also use asynchronous, message-based communication for inter-service communication using for example the <a href="https://www.amqp.org">AMQP Protocol</a>.</p><p>So, let‚Äôs have a look at how a very basic user microservice can be implemented in Vapor.</p><p>First, we need to configure the routes for the user service:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">func</span> <span class="nf">routes</span><span class="p">(</span><span class="n">_</span> <span class="nv">router</span><span class="p">:</span> <span class="kt">Router</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">userController</span> <span class="o">=</span> <span class="kt">UserController</span><span class="p">()</span>
    <span class="k">try</span> <span class="n">router</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="nv">collection</span><span class="p">:</span> <span class="n">userController</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The user service has two endpoints, one to register a new user and one to retrieve an existing user:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">struct</span> <span class="kt">UserController</span><span class="p">:</span> <span class="kt">RouteCollection</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">boot</span><span class="p">(</span><span class="nv">router</span><span class="p">:</span> <span class="kt">Router</span><span class="p">)</span> <span class="k">throws</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">usersRouter</span> <span class="o">=</span> <span class="n">router</span><span class="o">.</span><span class="nf">grouped</span><span class="p">(</span><span class="s">"users"</span><span class="p">)</span>
        
        <span class="n">usersRouter</span><span class="o">.</span><span class="nf">post</span><span class="p">(</span><span class="kt">CreateUserRequest</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">at</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span> <span class="nv">use</span><span class="p">:</span> <span class="n">register</span><span class="p">)</span>
        <span class="n">usersRouter</span><span class="o">.</span><span class="nf">post</span><span class="p">(</span><span class="kt">GetUserRequest</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">at</span><span class="p">:</span> <span class="s">"login"</span><span class="p">,</span> <span class="nv">use</span><span class="p">:</span> <span class="n">getUser</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Below is an example of how you can register a new user using PostgreSQL:</p><div class="language-swift highlighter-rouge"><div class="code-header"> <span data-label-text="Swift"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kd">private</span> <span class="kd">extension</span> <span class="kt">UserController</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">register</span><span class="p">(</span><span class="n">_</span> <span class="nv">req</span><span class="p">:</span> <span class="kt">Request</span><span class="p">,</span> <span class="nv">createRequest</span><span class="p">:</span> <span class="kt">CreateUserRequest</span><span class="p">)</span> <span class="k">throws</span> <span class="o">-&gt;</span> <span class="kt">Future</span><span class="o">&lt;</span><span class="kt">HTTPStatus</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">userRepository</span> <span class="o">=</span> <span class="k">try</span> <span class="n">req</span><span class="o">.</span><span class="nf">make</span><span class="p">(</span><span class="kt">UserRepository</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">try</span> <span class="n">userRepository</span><span class="o">.</span><span class="nf">findCount</span><span class="p">(</span><span class="nv">username</span><span class="p">:</span> <span class="n">createRequest</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="nv">email</span><span class="p">:</span> <span class="n">createRequest</span><span class="o">.</span><span class="n">email</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="n">req</span><span class="p">)</span><span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="n">count</span> <span class="k">in</span>
            <span class="k">guard</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="kt">Abort</span><span class="p">(</span><span class="o">.</span><span class="n">badRequest</span><span class="p">,</span> <span class="nv">reason</span><span class="p">:</span> <span class="s">"A user with these credentials already exists."</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">try</span> <span class="n">createRequest</span><span class="o">.</span><span class="nf">validate</span><span class="p">()</span>
            <span class="k">let</span> <span class="nv">bcrypt</span> <span class="o">=</span> <span class="k">try</span> <span class="n">req</span><span class="o">.</span><span class="nf">make</span><span class="p">(</span><span class="kt">BCryptDigest</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
            <span class="k">let</span> <span class="nv">hashedPassword</span> <span class="o">=</span> <span class="k">try</span> <span class="n">bcrypt</span><span class="o">.</span><span class="nf">hash</span><span class="p">(</span><span class="n">createRequest</span><span class="o">.</span><span class="n">password</span><span class="p">)</span>
            <span class="k">let</span> <span class="nv">user</span> <span class="o">=</span> <span class="kt">User</span><span class="p">(</span><span class="nv">username</span><span class="p">:</span> <span class="n">createRequest</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="nv">email</span><span class="p">:</span> <span class="n">createRequest</span><span class="o">.</span><span class="n">email</span><span class="p">,</span> <span class="nv">password</span><span class="p">:</span> <span class="n">hashedPassword</span><span class="p">)</span>
            <span class="k">return</span> <span class="k">try</span> <span class="n">userRepository</span><span class="o">.</span><span class="nf">save</span><span class="p">(</span><span class="nv">user</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="n">req</span><span class="p">)</span><span class="o">.</span><span class="nf">transform</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="kt">HTTPStatus</span><span class="o">.</span><span class="n">created</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>As with every other architecture out there, there is no silver bullet and microservices are no exception. The Microservices architectures have many drawbacks ranging from added deployment complexity to testing which should be taken into consideration during the planning phases of your project. With that said it is still a great choice for complex, evolving applications despite drawbacks and implementation challenges.</p><p>Here are links to my GitHub repositories containing the example code:</p><ul><li><a href="https://github.com/rynaardb/vapor-microservices-api-gateway">vapor-microservices-api-gateway</a><li><a href="https://github.com/rynaardb/vapor-microservices-user-service">vapor-microservices-user-service</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/swift/'>swift</a>, <a href='/categories/vapor/'>vapor</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/vapor/" class="post-tag no-text-decoration" >vapor</a> <a href="/tags/server-side/" class="post-tag no-text-decoration" >server-side</a> <a href="/tags/swift/" class="post-tag no-text-decoration" >swift</a> <a href="/tags/microservices/" class="post-tag no-text-decoration" >microservices</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Microservices%20with%20Vapor%20-%20Rynaard%20Burger&url=https%3A%2F%2Frynaardb.com%2Fposts%2Fmicroservices-with-vapor%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Microservices%20with%20Vapor%20-%20Rynaard%20Burger&u=https%3A%2F%2Frynaardb.com%2Fposts%2Fmicroservices-with-vapor%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Frynaardb.com%2Fposts%2Fmicroservices-with-vapor%2F&text=Microservices%20with%20Vapor%20-%20Rynaard%20Burger" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Frynaardb.com%2Fposts%2Fmicroservices-with-vapor%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin" > <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/ephemeral-builds-empowering-efficient-and-disposable-build-environments/">Ephemeral Builds - Empowering Efficient and Disposable Build Environments</a><li class="text-truncate lh-lg"> <a href="/posts/docker-multi-stage-builds/">Docker Multi-stage Builds</a><li class="text-truncate lh-lg"> <a href="/posts/progressive-delivery-techniques-in-devops/">Progressive Delivery Techniques in DevOps</a><li class="text-truncate lh-lg"> <a href="/posts/detect-and-prevent-deployment-drift-in-kubernetes/">Detect and Prevent Deployment Drift in Kubernetes</a><li class="text-truncate lh-lg"> <a href="/posts/testing-docker-images-tools-and-best-practices/">Testing Docker Images - Tools and Best Practices</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/iac/">iac</a> <a class="post-tag btn btn-outline-primary" href="/tags/infrastructure-as-code/">infrastructure-as-code</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/devops/">devops</a> <a class="post-tag btn btn-outline-primary" href="/tags/terraform/">terraform</a> <a class="post-tag btn btn-outline-primary" href="/tags/xcode/">xcode</a> <a class="post-tag btn btn-outline-primary" href="/tags/ci-cd/">ci-cd</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai/">ai</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/getting-started-with-vapor/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1549576800" data-df="ll" > Feb 8, 2019 </em><h4 class="pt-0 my-2" data-toc-skip>Getting started with Vapor</h4><div class="text-muted small"><p> Getting started with Vapor is easy thanks to the handy Vapor Toolbox and well written documentation. Prerequisites Swift 4.1 (bundled with Xcode) Xcode 9.3 or higher (optional if you install...</p></div></div></a></div><div class="col"> <a href="/posts/basic-uiview-animations/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1550268000" data-df="ll" > Feb 16, 2019 </em><h4 class="pt-0 my-2" data-toc-skip>Basic UIView Animations</h4><div class="text-muted small"><p> Subtle and concise animations can help draw the user‚Äôs attention to a specific area of your application. Often it may be unclear to the user when to perform a certain action or as to what is going ...</p></div></div></a></div><div class="col"> <a href="/posts/ios-animations-using-lottie/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1552687200" data-df="ll" > Mar 16, 2019 </em><h4 class="pt-0 my-2" data-toc-skip>iOS animations using Lottie</h4><div class="text-muted small"><p> Lottie is a mobile library for iOS and Android that parses Adobe After Effects animations exported as JSON with bodymovin and renders the vector animations natively on mobile and through React Nati...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/basic-uiview-animations/" class="btn btn-outline-primary" prompt="Older" ><p>Basic UIView Animations</p></a> <a href="/posts/ios-animations-using-lottie/" class="btn btn-outline-primary" prompt="Newer" ><p>iOS animations using Lottie</p></a></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/swift/">swift</a> <a class="post-tag btn btn-outline-primary" href="/tags/iac/">iac</a> <a class="post-tag btn btn-outline-primary" href="/tags/infrastructure-as-code/">infrastructure-as-code</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/devops/">devops</a> <a class="post-tag btn btn-outline-primary" href="/tags/terraform/">terraform</a> <a class="post-tag btn btn-outline-primary" href="/tags/xcode/">xcode</a> <a class="post-tag btn btn-outline-primary" href="/tags/ci-cd/">ci-cd</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/ai/">ai</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>rynaardb.com</p><p>¬© 2023 <a href="https://twitter.com/rynaardb">Rynaard Burger</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-N0LQM86HKV"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-N0LQM86HKV'); }); </script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3797894884439015" crossorigin="anonymous"></script> <a rel="me" href="https://github.com/rynaardb">GitHub</a> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
